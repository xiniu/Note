# 开篇词 C++这么难，为什么我们还要用C++？

## C++是一门多范式的通用编程语言

- 支持面向过程编程
- 支持面向对象编程
- 支持繁星编程
- 新版本还支持函数式编程

## 一些著名的用到C++的场景

- 大型桌面应用程序（Adobe Photoshop、Google Chrome和Microsoft Office）
- 大型网站后台（如Google的搜索引擎）
- 游戏和游戏引擎（Unity）
- 编译器（LLVM/Clang和GCC）
- 解释器（如Java虚拟机和V8 JavaScript引擎）
- 实时控制（战斗机的飞行控制、火星车的自动驾驶系统）
- 视觉和智能引擎（OpenCV、TensorFlow）
- 数据库（MicroSo SQL Server、 MySql、MongoDB）

## C++的竞争力

- 抽象能力：抽象能力代表着更高的开发效率；更为重要的是，不会因此而降低性能
- 性能：快且占用资源少
- 功耗：更性能相关，性能好了功耗自然低

## 什么时候该用C++

只需要回答一个问题：你在开发上付出的额外时间，能从性能上省回来吗？----C++需要的代码行数一般是Python的三倍左右，而性能可以达到Python的十倍以上。C++是解决性能问题的利器

# 课前必读 有关术语发音及环境要求

## 几个术语

| 英文 | 含义 |
| :--- | :---- |
| decltype |  |
| declval  |  |
| SFINAE   |  |

## 环境要求

大部分时间不会使用超过C++17标准的语言特性。
- 使用GCC的话，推荐使用下面的命令行
```
g++ -std=c++17 -W -Wall -Wfatal-errors filename
```
- 使用MSVC的话：
```
cl /std:c++17 /EHsc /W3 filename
```

# 堆、栈、RAII：C++里应该如何管理资源

## 基本概念：

- 堆（heap），在内存管理语境下，指的是同台分配的内存区域（跟数据结构中的堆不是一回事）。这里的内存使用后需要手工释放，否则造成内存泄漏。
- 自由存储区（free store），特指使用new和delete来分配和释放的内存区域，一般而言是堆的子集（new/delete---> free store;  malloc/free--->heap）
- 栈（stack），在内存管理预警下指的是函数调用过程中产生的本地变量和调用数据的区域（跟数据结构的栈高度相似，满足 last-in-first-out--->LIFO）
- RAII（Resource Acquisition Is Initialzation），C++特有的资源管理方式，C++是唯一一个依赖RAII来做资源管理的。RAII依赖栈和析构函数，来对所有资源进行管理

## 堆

使用堆或者说使用动态内存分配，是一件再自然不过的事情
- C++里的new和malloc导致在堆上分配内存（并构造对象）
```
auto ptr = new std::vector<int>();
```
- 历史上看，动态分配内存实际出现较晚。因为动态分配内存带来不确定性：
  - 耗时需要多久
  - 失败了怎么办
  - 至今仍然有很多场合禁用动态内存，例如飞行控制器和电信设备
 - 三个基本的内存管理器操作（C++一般只12，Java做13，而Python做123）：
  - 1让内存管理器分配一个某个大下的内存块
  - 2让内存管理器释放一个之前分配的内存块
  - 3让内存管理器做垃圾回收，寻找不再使用的内存并释放 















